<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Methodology &#8212; SET 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="_static/satellite.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Developer Guide" href="dev/dev.html" />
    <link rel="prev" title="Tutorial" href="usr/tutorial.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          SET</a>
        <span class="navbar-text navbar-version pull-left"><b>0.0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Index <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html"><strong>Program Overview</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="usr/installation.html"><strong>Installation</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="usr/tutorial.html"><strong>Tutorial</strong></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><strong>Methodology</strong></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dev/dev.html"><strong>Developer Guide</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="dev/site.html"><strong>Updating The Site</strong></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="trouble/faq.html"><strong>FAQ</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="trouble/contact.html"><strong>Contact</strong></a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#"><strong>Methodology</strong></a><ul>
<li><a class="reference internal" href="#kernel-creation"><strong>Kernel Creation</strong></a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="usr/tutorial.html" title="Previous Chapter: Tutorial"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Tutorial</span>
    </a>
  </li>
  <li>
    <a href="dev/dev.html" title="Next Chapter: Developer Guide"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Developer Guide &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/method.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="methodology">
<h1><strong>Methodology</strong><a class="headerlink" href="#methodology" title="Permalink to this headline">¶</a></h1>
<p>This page gives insight into the way the computer model applies the physics and geometry of light propagation. It involves extensive applications of spherical trigonometry and programming, and it may be necessary to review key concepts. Although not necessary to operate the program, understanding the methodology offers benefits for anyone looking to improve SET or use it for academic purposes.</p>
<div class="section" id="kernel-creation">
<h2><strong>Kernel Creation</strong><a class="headerlink" href="#kernel-creation" title="Permalink to this headline">¶</a></h2>
<p>All of SET’s methods for applying its light propagation model are in the file <code class="docutils literal"><span class="pre">Itest.py</span></code>, which executes the <code class="docutils literal"><span class="pre">main</span></code> function. In this function, SET first checks if a kernel is already created and, if no kernel is supplied, creates a kernel. A kernel is essentially a matrix with numerical coefficients representing the weight of light scattering from the source to the line of sight of the observer. Each pixel in the kernel thus contains a unitless value that compares the amount of light emitted from the ground to the amount of light scattered.</p>
<p>The kernel creation process is executed in <code class="docutils literal"><span class="pre">main</span></code> in lines 30-38:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">kerneltiffpath</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
    <span class="c1"># Estimate the 2d propagation function</span>
    <span class="c1"># bottom bottom_lat = 40.8797</span>
    <span class="c1"># top lat= 46.755666</span>
    <span class="n">propkernel</span><span class="p">,</span> <span class="n">totaltime</span> <span class="o">=</span> <span class="n">fsum_2d</span><span class="p">(</span><span class="n">regionlat_arg</span><span class="p">,</span> <span class="n">k_am_arg</span><span class="p">,</span> <span class="n">zen_arg</span><span class="p">,</span> <span class="n">azimuth_arg</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;propagation array: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">propkernel</span><span class="p">)</span>
    <span class="n">kerneltiffpath</span> <span class="o">=</span> <span class="s1">&#39;kernel_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">regionlat_arg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="n">k_am_arg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zen_arg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">azimuth_arg</span><span class="p">)</span>
    <span class="n">array_to_geotiff</span><span class="p">(</span><span class="n">propkernel</span><span class="p">,</span> <span class="n">kerneltiffpath</span><span class="p">,</span> <span class="n">filein</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;time for prop function ubreak 10: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">totaltime</span><span class="p">)</span>
</pre></div>
</div>
<p>The block calls <code class="docutils literal"><span class="pre">fsum_2d</span></code>, which goes from line 109-230 and produces the array that serves as the light propagation kernel. <code class="docutils literal"><span class="pre">fsum_2d</span></code> begins by gathering several inputs: regional latitude, Earth radius, and the array of beta angles. By applying the <a class="reference external" href="https://en.wikipedia.org/wiki/Haversine_formula">haversine formula</a>, the program then creates an array of the distances from the observation site to the light sources along an ellipsoid surface, <em>D</em>, from the latitude and Earth radius.</p>
<div class="figure align-right" id="id1" style="width: 500px">
<img alt="_images/cinzano_diagram.PNG" src="_images/cinzano_diagram.PNG" />
<p class="caption"><span class="caption-text"><em>Diagram of the light propagation model created by Cinzano. Shows the relationships between the observation site and the light source. Taken and modified from REF 2, Fig. 6, p.648.</em></span></p>
</div>
<p>Additionally, an array of beta angles, <span class="math">\(\beta\)</span>, is created that corresponds with the array of great circle distances.</p>
<p>References:</p>
<ol class="arabic simple">
<li>Falchi, F., P. Cinzano, D. Duriscoe, C.C.M. Kyba, C.D. Elvidge, K. Baugh, B.A. Portnov, N.A. Rybnikova and R. Furgoni, 2016. The new workd atlas of artificial night sky brightness. Sci. Adv. 2.</li>
<li>Cinzano, P., F. Falchi, C.D. Elvidge and  K.E. Baugh, 2000. The artificial night sky brightness mapped from DMSP satellite Operational Linescan System measurements. Mon. Not. R. Astron. Soc. 318.</li>
<li>Garstang, R.H., 1989. Night-sky brightness at observatories and sites. Pub. Astron. Soc. Pac. 101.</li>
</ol>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017, Ryan Avery, Stanley Yu, Kenton Ross, Veronica Warda, Steven Chao.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.<br/>
Icons made by <a href="http://www.flaticon.com/authors/madebyoliver" title="Madebyoliver">Madebyoliver</a> from <a href="http://www.flaticon.com/" title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a>.<br/>
    </p>
  </div>
</footer>


  </body>
</html>