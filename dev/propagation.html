<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>How to calculate how light scatters from a Source to a Site &#8212; SET 0.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/satellite.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Updating The Site" href="site.html" />
    <link rel="prev" title="Development Environment" href="environment.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          SET</a>
        <span class="navbar-text navbar-version pull-left"><b>0.0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Index <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html"><strong>Program Overview</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../usr/installation.html"><strong>Installation</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../usr/tutorial.html"><strong>Tutorial</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../method.html"><strong>Methodology</strong></a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="dev.html"><strong>Developer Guide</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="site.html"><strong>Updating The Site</strong></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../trouble/faq.html"><strong>FAQ</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../trouble/contact.html"><strong>Contact</strong></a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#"><strong>How to calculate how light scatters from a Source to a Site</strong></a><ul>
<li><a class="reference internal" href="#summary-and-references"><strong>Summary and References</strong></a></li>
<li><a class="reference internal" href="#fsum-single-code-organization"><code class="docutils literal"><span class="pre">fsum_single()</span></code> <strong>Code Organization</strong></a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="environment.html" title="Previous Chapter: Development Environment"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Development E...</span>
    </a>
  </li>
  <li>
    <a href="site.html" title="Next Chapter: Updating The Site"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Updating The Site &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/dev/propagation.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="how-to-calculate-how-light-scatters-from-a-source-to-a-site">
<h1><strong>How to calculate how light scatters from a Source to a Site</strong><a class="headerlink" href="#how-to-calculate-how-light-scatters-from-a-source-to-a-site" title="Permalink to this headline">¶</a></h1>
<div class="section" id="summary-and-references">
<h2><strong>Summary and References</strong><a class="headerlink" href="#summary-and-references" title="Permalink to this headline">¶</a></h2>
<p>Our model of light propagation is based on three papers.</p>
<ol class="arabic simple">
<li>Falchi, F., P. Cinzano, D. Duriscoe, C.C.M. Kyba, C.D. Elvidge, K. Baugh, B.A. Portnov, N.A. Rybnikova and R. Furgoni, 2016. The new world atlas of artificial night sky brightness. Sci. Adv. 2.</li>
<li>Cinzano, P., F. Falchi, C.D. Elvidge and  K.E. Baugh, 2000. The artificial night sky brightness mapped from DMSP satellite Operational Linescan System measurements. Mon. Not. R. Astron. Soc. 318.</li>
<li>Garstang, R.H., 1989. Night-sky brightness at observatories and sites. Pub. Astron. Soc. Pac. 101.</li>
</ol>
<p>These papers are the foundation for the part of our code that calculates how light scatters from a source (C) to a site (O for observer). In our case, values of light emission from the source are sensed by VIIRS and recorded as pixel values, and each pixel area over our study area is a site. This explanation will cover the inner workings of the function <code class="docutils literal"><span class="pre">fsum_single()</span></code>, which takes as arguments parameters that govern how light scatters from a C to O, and outputs a ratio that determines the total amount of light that arrives at the line of sight of viewer standing at O.</p>
<p>The following adapted diagram from (2) shows the relavant geometry parameters that govern how light scatters from a C to a O:</p>
<img alt="dev/../_static/cinzano_diagram.png" src="dev/../_static/cinzano_diagram.png" />
</div>
<div class="section" id="fsum-single-code-organization">
<h2><code class="docutils literal"><span class="pre">fsum_single()</span></code> <strong>Code Organization</strong><a class="headerlink" href="#fsum-single-code-organization" title="Permalink to this headline">¶</a></h2>
<p>Each equation in <code class="docutils literal"><span class="pre">fsum_single()</span></code> that is taken from any of the papers that detail our model for light pollution are referenced as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># s, Distance from source to scattering CQ, REF 2, Appendix A (A1), p. 656</span>
<span class="c1"># equation is wrong in Ref 2 (Cinzano). Changed Chi to theta according to Ref 3, p. 308, Equation 7 (Garstang)</span>
<span class="n">s_CQ</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">u_OQ</span> <span class="o">-</span> <span class="n">l_OC</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">u_OQ</span><span class="o">*</span><span class="n">l_OC</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># km</span>

<span class="c1"># h, Height of scattering above Earth reference surface Q, REF 2, Appendix A (A1), p. 656</span>
<span class="n">h_Q</span> <span class="o">=</span> <span class="n">R_T</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">u_OQ</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">u_OQ</span><span class="o">*</span><span class="n">R_T</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">zen</span><span class="p">))</span><span class="o">/</span><span class="n">R_T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># km</span>

<span class="c1"># phi, Elevation angle of emission over line of sight from C to O (QCO), REF 2, Appendix A (A1), p. 656</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">arccos</span><span class="p">((</span><span class="n">l_OC</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">s_CQ</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">u_OQ</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">l_OC</span><span class="o">*</span><span class="n">s_CQ</span><span class="p">))</span> <span class="c1"># radians</span>
<span class="n">phi_deg</span> <span class="o">=</span> <span class="n">phi</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span> <span class="c1"># degrees</span>
</pre></div>
</div>
<p>Above each equation or constant, there is a comment with a short explanation of the variable, a reference, and page number. Starting out with the code, there are a lot of equations to understand and the task of digesting them all can seem daunting! never fear. You do not need to meticulously know the reason behind every equation unless you are interested in the physics/geometry of light scattering. It’s just important to know where these equations come from and how to examine their meaning should you need to do so for debugging purposes. We will go over some of the most relevant parts of <code class="docutils literal"><span class="pre">fsum_single()</span></code> that you may need to change.</p>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017, Ryan Avery, Stanley Yu, Kenton Ross, Veronica Warda, Steven Chao.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.<br/>
Icons made by <a href="http://www.flaticon.com/authors/madebyoliver" title="Madebyoliver">Madebyoliver</a> from <a href="http://www.flaticon.com/" title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a>.<br/>
    </p>
  </div>
</footer>


  </body>
</html>